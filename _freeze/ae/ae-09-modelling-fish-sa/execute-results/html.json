{
  "hash": "bb7717ba8019507218afbd4260b30d2b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Modelling fish\"\nsubtitle: \"Suggested answers\"\ncategories: \n  - Application exercise\n  - Answers\neditor: visual\n---\n\n\nFor this application exercise, we will work with data on fish. The dataset we will use, called `fish`, is on two common fish species in fish market sales.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\n\nfish <- read_csv(\"data/fish.csv\")\n```\n:::\n\n\nThe data dictionary is below:\n\n| **variable**      | **description**        |\n|-------------------|------------------------|\n| `species`         | Species name of fish   |\n| `weight`          | Weight, in grams       |\n| `length_vertical` | Vertical length, in cm |\n| `length_diagonal` | Diagonal length, in cm |\n| `length_cross`    | Cross length, in cm    |\n| `height`          | Height, in cm          |\n| `width`           | Diagonal width, in cm  |\n\n# Visualizing the model\n\nWe're going to investigate the relationship between the weights and heights of fish.\n\n-   **Demo:** Create an appropriate plot to investigate this relationship. Add appropriate labels to the plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(fish, aes(x = height, y = weight)) +\n  geom_point() +\n  labs(\n    title = \"Weights vs. heights of fish\",\n    x = \"Height (cm)\",\n    y = \"Weight (gr)\"\n  )\n```\n\n::: {.cell-output-display}\n![](ae-09-modelling-fish-sa_files/figure-html/plot-hw-1.png){width=672}\n:::\n:::\n\n\n-   **Your turn:**\n\n    -   If you were to draw a a straight line to best represent the relationship between the heights and weights of fish, where would it go? Why?\n\n        *Start from the bottom and go up. Identify the first and last point and draw a line through most the others.*\n\n    -   Overlay the line of best fit.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    ggplot(fish, aes(x = height, y = weight)) +\n      geom_point() +\n      geom_smooth(method = \"lm\") +\n      labs(\n        title = \"Weights vs. lengths of fish\",\n        x = \"Head-to-tail lentgh (cm)\",\n        y = \"Weight of fish (grams)\"\n      )\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    \n    ```\n    `geom_smooth()` using formula = 'y ~ x'\n    ```\n    \n    \n    :::\n    \n    ::: {.cell-output-display}\n    ![](ae-09-modelling-fish-sa_files/figure-html/plot-hw-lm-1.png){width=672}\n    :::\n    :::\n\n\n    -   What types of questions can this plot help answer?\n\n        *Is there a relationship between fish heights and weights of fish?*\n\n-   ***Your turn:***\n\n    -   We can use this line to make predictions. Predict what you think the weight of a fish would be with a height of 10 cm, 15 cm, and 20 cm. Which prediction is considered extrapolation?\n\n        *At 10 cm, we estimate a weight of 375 grams. At 15 cm, we estimate a weight of 600 grams At 20 cm, we estimate a weight of 975 grams. 20 cm would be considered extrapolation.*\n\n    -   What is a residual?\n\n        *Difference between predicted and observed.*\n\n# Model fitting\n\n-   **Demo:** Fit a model to predict fish weights from their heights.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfish_hw_fit <- linear_reg() |>\n  fit(weight ~ height, data = fish)\n\nfish_hw_fit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nparsnip model object\n\n\nCall:\nstats::lm(formula = weight ~ height, data = data)\n\nCoefficients:\n(Intercept)       height  \n    -288.42        60.92  \n```\n\n\n:::\n:::\n\n\n-   **Your turn:** Predict what the weight of a fish would be with a height of 10 cm, 15 cm, and 20 cm using this model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(10, 15, 20)\n-288 + 60.92 * x\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 321.2 625.8 930.4\n```\n\n\n:::\n:::\n\n\n-   **Demo:** Calculate predicted weights for all fish in the data and visualize the residuals under this model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfish_hw_aug <- augment(fish_hw_fit$fit)\n\nggplot(fish_hw_aug, aes(x = height, y = weight)) + \n  geom_point() + \n  geom_smooth(method = \"lm\", se = FALSE, color = \"lightgrey\") +  \n  geom_segment(aes(xend = height, yend = .fitted), color = \"gray\") +  \n  geom_point(aes(y = .fitted), shape = \"circle open\") + \n  theme_minimal() +\n  labs(\n    title = \"Weights vs. heights of fish\",\n    subtitle = \"Residuals\",\n    x = \"Height (cm)\",\n    y = \"Weight (gr)\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ae-09-modelling-fish-sa_files/figure-html/residuals-1.png){width=672}\n:::\n:::\n\n\n# Model summary\n\n-   **Demo:** Display the model summary including estimates for the slope and intercept along with measurements of uncertainty around them. Show how you can extract these values from the model output.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfish_hw_tidy <- tidy(fish_hw_fit)\n\n# intercept\nfish_hw_tidy |>\n  filter(term == \"(Intercept)\") |>\n  pull(estimate)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -288.4152\n```\n\n\n:::\n\n```{.r .cell-code}\n# slope\nfish_hw_tidy |>\n  filter(term == \"height\") |>\n  pull(estimate)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 60.91587\n```\n\n\n:::\n:::\n\n\n-   **Demo:** Write out your model using mathematical notation.\n\n$\\widehat{weight} = 1.96 + 0.233 \\times height$\n\n# Correlation\n\nWe can also assess correlation between two quantitative variables.\n\n-   **Your turn:** What is correlation? What are values correlation can take?\n\n    *Strength and direction of a linear relationship. It's bounded by -1 and 1.*\n\n-   **Demo:** What is the correlation between heights and weights of fish?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfish |>\n  summarize(r = cor(height, weight))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 Ã— 1\n      r\n  <dbl>\n1 0.954\n```\n\n\n:::\n:::\n\n\n# Adding a third variable\n\n-   **Demo:** Does the relationship between heights and weights of fish change if we take into consideration species? Plot two separate straight lines for the Bream and Roach species.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(fish, \n       aes(x = height, y = weight, color = species)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  labs(\n    title = \"Weights vs. heights of fish\",\n    x = \"Height (cm)\",\n    y = \"Weight (gr)\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ae-09-modelling-fish-sa_files/figure-html/plot-hws-lm-1.png){width=672}\n:::\n:::\n\n\n# Fitting other models\n\n-   **Demo:** We can fit more models than just a straight line. Change the following code below to read `method = \"loess\"`. What is different from the plot created before?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(fish, \n       aes(x = height, y = weight)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  labs(\n    title = \"Weights vs. heights of fish\",\n    x = \"Height (cm)\",\n    y = \"Weight (gr)\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ae-09-modelling-fish-sa_files/figure-html/plot-hw-loess-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "ae-09-modelling-fish-sa_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}